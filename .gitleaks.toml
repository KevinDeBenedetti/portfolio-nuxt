title = "Strict Gitleaks Configuration for Nuxt Project"

[extend]
useDefault = true

[[rules]]
id = "github-token-custom"
description = "GitHub Personal Access Token personnalisé"
regex = '''ghp_[a-zA-Z0-9]{36,}'''
tags = ["github", "token", "api"]
keywords = ["ghp_"]

[[rules]]
id = "admin-password"
description = "Mot de passe admin hardcodé"
regex = '''(?i)(admin|root|user)password\s*[:=]\s*['"]([^'"]{4,})['"]'''
secretGroup = 2
tags = ["password", "admin"]
keywords = ["password", "adminPassword"]

[[rules]]
id = "simple-password-field"
description = "Champs password avec valeurs hardcodées"
regex = '''(?i)password\s*[:=]\s*['"]([^'"]{4,})['"]'''
secretGroup = 1
tags = ["password", "hardcoded"]
keywords = ["password"]

# Allowlist pour ignorer les Google Analytics IDs (pas vraiment des secrets)
[[allowlists]]
description = "Ignorer les Google Analytics IDs (publics)"
regexTarget = "match"
regexes = [
    '''G-[A-Z0-9]{10}''',
    '''process\.env\.\w+''',
    '''process\.env\.NUXT_\w+''',
]